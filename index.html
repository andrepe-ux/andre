<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Combinar PDFs</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
<style>
    body {
        background-color: #ececec;
        font-family: Arial, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
    }
    .container {
        text-align: center;
        width: 80%;
        max-width: 600px;
        background-color: #f9f9f9;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 15px rgba(0,0,0,0.1);
        position: relative;
    }
    h2 {
        font-weight: bold;
        color: #333;
    }
    .drop-zone {
        border: 2px dashed #a0a0a0;
        padding: 30px;
        margin: 20px 0;
        background-color: #f0f0f0;
        border-radius: 10px;
        min-height: 200px;
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        transition: background-color 0.3s, border-color 0.3s;
    }
    .drop-zone.dragover {
        background-color: #d0d0d0;
        border-color: #8fbc8f;
    }
    button {
        padding: 10px 20px;
        background-color: #8fbc8f;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        transition: background-color 0.3s;
    }
    button:hover {
        background-color: #6e8f6e;
    }
    .success-message {
        font-size: 16px;
        font-weight: bold;
        color: #6e8f6e;
        text-align: center;
        display: none;
        opacity: 0;
        transition: opacity 0.5s ease-in-out;
        margin-top: 20px;
    }
    .success-message.show {
        display: block;
        opacity: 1;
    }
    .btn-reset {
        margin-top: 20px;
        background-color: #6e8f6e;
        color: white;
    }
    .lang-selector {
        position: absolute;
        top: 10px;
        right: 10px;
        display: flex;
        gap: 10px;
    }
    .lang-selector img {
        width: 32px;
        height: 20px;
        cursor: pointer;
        border: 1px solid transparent;
        border-radius: 3px;
        transition: border 0.3s, box-shadow 0.3s;
    }
    .lang-selector img.active {
        border: 2px solid #333;
        box-shadow: 0 0 5px rgba(0,0,0,0.5);
    }
    #download {
        display: none;
        padding: 10px 20px;
        background-color: #4a7a4a; /* verde escuro */
        color: white;
        border-radius: 5px;
        text-decoration: none;
        margin-top: 10px;
        display: inline-block;
        transition: background-color 0.3s;
    }
    #download:hover {
        background-color: #3b5d3b; /* verde ainda mais escuro */
    }
</style>
</head>
<body>

<div class="container">
    <!-- Seletor de idioma com bandeiras -->
    <div class="lang-selector">
        <img src="https://upload.wikimedia.org/wikipedia/commons/5/5c/Flag_of_Portugal.svg" id="ptFlag" alt="Português" class="active">
        <img src="https://upload.wikimedia.org/wikipedia/commons/9/9a/Flag_of_Spain.svg" id="esFlag" alt="Español">
    </div>

    <h2 id="title">Junta os teus PDF's</h2>

    <div class="drop-zone" id="dropzone1">
        <input type="file" id="pdf1" accept="application/pdf" style="display:none;" />
        <button id="btn1">Escolher primeiro PDF</button>
        <div id="message1" class="success-message">DOCUMENTO INSERIDO COM SUCESSO</div>
    </div>

    <div class="drop-zone" id="dropzone2">
        <input type="file" id="pdf2" accept="application/pdf" style="display:none;" />
        <button id="btn2">Escolher segundo PDF</button>
        <div id="message2" class="success-message">DOCUMENTO INSERIDO COM SUCESSO</div>
    </div>

    <div class="drop-zone" id="dropzone3">
        <input type="file" id="pdf3" accept="application/pdf" style="display:none;" />
        <button id="btn3">Escolher terceiro PDF</button>
        <div id="message3" class="success-message">DOCUMENTO INSERIDO COM SUCESSO</div>
    </div>

    <button id="combine">Combinar PDFs</button>
    <a id="download">Baixar PDF combinado</a>
    <button class="btn-reset" id="reset">Novo PDF</button>
</div>

<script>
const dropzones = [
    {drop: document.getElementById('dropzone1'), input: document.getElementById('pdf1'), button: document.getElementById('btn1'), message: document.getElementById('message1')},
    {drop: document.getElementById('dropzone2'), input: document.getElementById('pdf2'), button: document.getElementById('btn2'), message: document.getElementById('message2')},
    {drop: document.getElementById('dropzone3'), input: document.getElementById('pdf3'), button: document.getElementById('btn3'), message: document.getElementById('message3')}
];

const combineButton = document.getElementById('combine');
const downloadLink = document.getElementById('download');
const resetButton = document.getElementById('reset');
const ptFlag = document.getElementById('ptFlag');
const esFlag = document.getElementById('esFlag');
const title = document.getElementById('title');

let files = [null, null, null];
let lang = 'pt';

const text = {
    pt: {
        title: "Junta os teus PDF's",
        select1: "Escolher primeiro PDF",
        select2: "Escolher segundo PDF",
        select3: "Escolher terceiro PDF",
        success: "DOCUMENTO INSERIDO COM SUCESSO",
        combine: "Combinar PDFs",
        download: "Baixar PDF combinado",
        reset: "Novo PDF",
        alert: "Por favor, selecione pelo menos dois arquivos PDF."
    },
    es: {
        title: "Une tus PDFs",
        select1: "Seleccionar primer PDF",
        select2: "Seleccionar segundo PDF",
        select3: "Seleccionar tercer PDF",
        success: "DOCUMENTO INSERTADO CON ÉXITO",
        combine: "Combinar PDFs",
        download: "Descargar PDF combinado",
        reset: "Nuevo PDF",
        alert: "Por favor, selecciona al menos dos archivos PDF."
    }
};

function setLanguage(selectedLang) {
    lang = selectedLang;
    title.textContent = text[lang].title;
    document.getElementById('btn1').textContent = text[lang].select1;
    document.getElementById('btn2').textContent = text[lang].select2;
    document.getElementById('btn3').textContent = text[lang].select3;
    document.getElementById('message1').textContent = text[lang].success;
    document.getElementById('message2').textContent = text[lang].success;
    document.getElementById('message3').textContent = text[lang].success;
    combineButton.textContent = text[lang].combine;
    downloadLink.textContent = text[lang].download;
    resetButton.textContent = text[lang].reset;

    ptFlag.classList.toggle('active', lang === 'pt');
    esFlag.classList.toggle('active', lang === 'es');
}

ptFlag.addEventListener('click', () => setLanguage('pt'));
esFlag.addEventListener('click', () => setLanguage('es'));

dropzones.forEach((zone, index) => {
    zone.drop.addEventListener('dragover', e => { e.preventDefault(); zone.drop.classList.add('dragover'); });
    zone.drop.addEventListener('dragleave', () => zone.drop.classList.remove('dragover'));
    zone.drop.addEventListener('drop', e => {
        e.preventDefault();
        zone.drop.classList.remove('dragover');
        if (e.dataTransfer.files.length > 0) handleFileSuccess(e.dataTransfer.files[0], zone.message, zone.button, index);
    });

    zone.button.addEventListener('click', () => zone.input.click());

    zone.input.addEventListener('change', e => {
        if (e.target.files.length > 0) handleFileSuccess(e.target.files[0], zone.message, zone.button, index);
    });
});

function handleFileSuccess(file, messageElement, buttonElement, index) {
    files[index] = file;
    buttonElement.style.display = 'none';
    messageElement.classList.add('show');
}

combineButton.addEventListener('click', async () => {
    const selectedFiles = files.filter(f => f !== null);
    if (selectedFiles.length < 2) {
        alert(text[lang].alert);
        return;
    }
    const pdfDoc = await PDFLib.PDFDocument.create();
    for (const file of selectedFiles) {
        const pdfBytes = await file.arrayBuffer();
        const pdfToAdd = await PDFLib.PDFDocument.load(pdfBytes);
        const pages = await pdfDoc.copyPages(pdfToAdd, pdfToAdd.getPageIndices());
        pages.forEach(page => pdfDoc.addPage(page));
    }
    const pdfBytes = await pdfDoc.save();
    const blob = new Blob([pdfBytes], {type: 'application/pdf'});
    downloadLink.href = URL.createObjectURL(blob);
    downloadLink.download = 'pdf_combinado.pdf';
    downloadLink.style.display = 'inline-block'; // mostra como botão verde
    downloadLink.textContent = text[lang].download;
});

resetButton.addEventListener('click', () => {
    files = [null, null, null];
    dropzones.forEach(zone => {
        zone.input.value = '';
        zone.button.style.display = 'block';
        zone.message.classList.remove('show');
        zone.drop.classList.remove('dragover');
    });
    downloadLink.style.display = 'none';
});
</script>

</body>
</html>
